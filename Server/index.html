<!DOCTYPE html>

<head>
    <meta charset="UTF_8" />
    <title>Sample hosted HTML</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript">
        let UserName = "FB1";
        let message = null;

        function Send() {
            let time = 30;
            let tmp = { name: UserName, time: time, text: message };
            tmp = JSON.stringify(tmp);
            fetch("/", { method: 'POST', body: tmp });
        };

        async function Get() {
            let data = await fetch("/Update", { method: 'GET' }).then(res => { return res.text() });
            data = data.split('\n');
            let tmp = "";
            data.forEach(function (val) { tmp += val + "<br>" });
            TextField.innerHTML = tmp;
        };

        function GetInit() {
            var Timer = setInterval(Get, 666);
        }

        function update_name() {
            UserName = Name.value;
        }
        function update_msg() {
            message = Msg.value;
        }
    </script>
</head>

<body onload="GetInit();">
    <div>
        <button id="SendButton" class="Button" onclick="Send();">
            <span class="ButtonText"> Send Message </span>
        </button><br>
        <button id="GetButton" class="Button" onclick="Get();">
            <span class="ButtonText"> Get messages</span>
        </button><br>

        <label for="Name" class="InputLabel"> UserName </label>
        <input type="text" id="Name" onkeyup="update_name()"><br>

        <label for="Msg" class="InputLabel"> Message </label>
        <input type="text" id="Msg" onkeyup="update_msg()"><br>

        <div class="MessagesList">
            <span class="TextField" id="TextField"> No messages were loaded </span>
        </div>
    </div>
</body>

</html>